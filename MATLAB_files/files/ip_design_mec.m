clear
format compact

h = 0.005;

Tf1 = 0.08;
Tf2 = 0.08;

% =============================================
g  = 9.81e+00;
L1 = 9.20e-02;  % 9.2cm

a1 = 1.25e+01;
b1 = 3.42e+01;

a2 = 1.59e-01;
b2 = 2.41e-02;

E = [ 1  0  0  0
      0  1  0  0
      0  0  1  0
      0  L1 0  a2 ];
F = [ 0  1  0  0
      0 -a1 0  0
      0  0  0  1
      0  0  g -b2 ];
G = [ 0
      b1
      0
      0 ];

% =============================================
A = inv(E)*F
B = inv(E)*G

q1 = 0.5;
q3 = 1;
Q = diag([q1 0 q3 0])
R = 1

K = -lqr(A,B,Q,R)

disp('***** A + B*K の固有値 *****')
eig(A + B*K)


% MEC ========================================
disp('***** 誤差補償器 D(s) *****')
kP = 10
kI = 0



